<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  

  
  <title>平凡的码农</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="平凡的码农">
<meta property="og:url" content="https://mengxu2018.github.io/page/2/index.html">
<meta property="og:site_name" content="平凡的码农">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="平凡的码农">
  
    <link rel="alternate" href="/atom.xml" title="平凡的码农" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">平凡的码农</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://mengxu2018.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-elasticsearch-remote-access" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/06/27/elasticsearch-remote-access/" class="article-date">
  <time datetime="2020-06-27T14:51:52.000Z" itemprop="datePublished">2020-06-27</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/06/27/elasticsearch-remote-access/">elasticsearch cluster</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/file-descriptors.html" target="_blank" rel="noopener">https://www.elastic.co/guide/en/elasticsearch/reference/current/file-descriptors.html</a><br><a href="https://discuss.elastic.co/t/problems-with-access-to-elasticsearch-form-outside-machine/172450" target="_blank" rel="noopener">https://discuss.elastic.co/t/problems-with-access-to-elasticsearch-form-outside-machine/172450</a></p>
<p>修改配置elasticsearch.yml<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">network.host: 0.0.0.0</span><br></pre></td></tr></table></figure></p>
<p>文件句柄问题就是修改/etc/security/limits.conf，下面的xuhang就是启动es的用户名<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">xuhang soft nofile 65536</span><br><span class="line">xuhang hard nofile 65536</span><br></pre></td></tr></table></figure></p>
<p>the default discovery settings are unsuitable for production use, 修改elasticsearch.yml<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">discovery.seed_hosts: []</span><br></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://mengxu2018.github.io/2020/06/27/elasticsearch-remote-access/" data-id="ckbxofai20000couxh5gafswo" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/search/">search</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-powershell概念" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/06/22/powershell概念/" class="article-date">
  <time datetime="2020-06-22T12:44:15.000Z" itemprop="datePublished">2020-06-22</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/06/22/powershell概念/">powershell 概念</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="net-powershell"><a href="#net-powershell" class="headerlink" title=".net powershell"></a>.net powershell</h2><p>The reason for this is that PowerShell commands can read and write objects, as opposed to conventional shells that can only process strings of text. Because PowerShell runs on the .NET platform, the objects that are used are .NET objects, which makes it an ideal scripting language for .NET programs.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://mengxu2018.github.io/2020/06/22/powershell概念/" data-id="ckbxofaj20006coux3tukd7zn" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/powershell/">powershell</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-powershell-sample" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/06/22/powershell-sample/" class="article-date">
  <time datetime="2020-06-22T12:44:15.000Z" itemprop="datePublished">2020-06-22</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/06/22/powershell-sample/">powershell sample</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="create-excel-前提是ms-office是安装好的"><a href="#create-excel-前提是ms-office是安装好的" class="headerlink" title="create excel(前提是ms office是安装好的)"></a>create excel(前提是ms office是安装好的)</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"># create new excel instance</span><br><span class="line"> $objExcel = New-Object -comobject Excel.Application</span><br><span class="line"> $objExcel.Visible = $True</span><br><span class="line"> $objWorkbook = $objExcel.Workbooks.Add()</span><br><span class="line"> $objWorksheet = $objWorkbook.Worksheets.Item(1)</span><br><span class="line"></span><br><span class="line"> # write information to the excel file</span><br><span class="line">$i = 0</span><br><span class="line">$first10 = (ps | sort ws -Descending | select -first 10)</span><br><span class="line">$first10 | foreach -Process &#123;$i++; $objWorksheet.Cells.Item($i,1) = $_.name; $objWorksheet.Cells.Item($i,2) = $_.ws&#125;</span><br><span class="line">$otherMem = (ps | measure ws -s).Sum - ($first10 | measure ws -s).Sum</span><br><span class="line">$objWorksheet.Cells.Item(11,1) = &quot;Others&quot;; $objWorksheet.Cells.Item(11,2) = $otherMem</span><br><span class="line"></span><br><span class="line"># draw the pie chart</span><br><span class="line">$objCharts = $objWorksheet.ChartObjects()</span><br><span class="line">$objChart = $objCharts.Add(0, 0, 500, 300)</span><br><span class="line">$objChart.Chart.SetSourceData($objWorksheet.range(&quot;A1:B11&quot;), 2)</span><br><span class="line">$objChart.Chart.ChartType = 70</span><br><span class="line">$objChart.Chart.ApplyDataLabels(5)</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://mengxu2018.github.io/2020/06/22/powershell-sample/" data-id="ckbxofaj50007coux3zhmkel8" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/powershell/">powershell</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-powershell-module" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/06/18/powershell-module/" class="article-date">
  <time datetime="2020-06-18T12:44:15.000Z" itemprop="datePublished">2020-06-18</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/06/18/powershell-module/">powershell module</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="guide"><a href="#guide" class="headerlink" title="guide"></a>guide</h2><p><a href="https://www.pstips.net/create-mini-module.html" target="_blank" rel="noopener">https://www.pstips.net/create-mini-module.html</a></p>
<h2 id="打开-powershell-ise"><a href="#打开-powershell-ise" class="headerlink" title="打开 powershell ise"></a>打开 powershell ise</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">function Get-BIOS</span><br><span class="line">&#123;  param($ComputerName, $Credential)</span><br><span class="line">   Get-WmiObject -Class Win32_BIOS @PSBoundParameters</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$name = &apos;Get-BIOS&apos;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">New-Item -Path $home\Documents\WindowsPowerShell\Modules\$name\$name.psm1 -ItemType File -Force -Value &quot;function $name &#123; $((Get-Item function:\$name).Definition) &#125;&quot; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">打开新窗口</span><br><span class="line"></span><br><span class="line">Get-Module  -Name Get-BIOS</span><br><span class="line">Get-BIOS</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://mengxu2018.github.io/2020/06/18/powershell-module/" data-id="ckbxofaj00005couxhkoiw2x8" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/powershell/">powershell</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-powershell常用命令" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/06/18/powershell常用命令/" class="article-date">
  <time datetime="2020-06-18T12:44:15.000Z" itemprop="datePublished">2020-06-18</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/06/18/powershell常用命令/">powershell 基础知识</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="todo"><a href="#todo" class="headerlink" title="todo"></a>todo</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 返回的就是一个object，所有可以call stop方法</span><br><span class="line">(Get-Service -Name w32time).Stop()</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://mengxu2018.github.io/2020/06/18/powershell常用命令/" data-id="ckbxofaj9000acouxv3lsir30" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/powershell/">powershell</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-网络协议" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/06/10/网络协议/" class="article-date">
  <time datetime="2020-06-10T14:51:52.000Z" itemprop="datePublished">2020-06-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/06/10/网络协议/">ping网络协议</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>ping  没有指定端口这个选项吧，他是网络层的，端口可是传输层的概念啊。</p>
<p>Ping程序使用的是ICMP协议，ICMP不像http，FTP应用层有传输层的端口号，（它们使用TCP的端口号80和20/21）。ICMP直接封装在IP包内</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://mengxu2018.github.io/2020/06/10/网络协议/" data-id="ckbxofajb000ccouxyyyeuxeo" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/网络/">网络</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-ansible-windows踩坑" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/06/04/ansible-windows踩坑/" class="article-date">
  <time datetime="2020-06-04T12:44:15.000Z" itemprop="datePublished">2020-06-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/06/04/ansible-windows踩坑/">ansible windows setup</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="1"><a href="#1" class="headerlink" title="1"></a>1</h2><p>/etc/ansible/hosts如下，ansible_winrm_transport是关键，否则会报错    “msg”: “plaintext: the specified credentials were rejected by the server”,<br><a href="https://www.jianshu.com/p/0ad50049adb7" target="_blank" rel="noopener">https://www.jianshu.com/p/0ad50049adb7</a></p>
<p>[windows]<br>node3 ansible_user=xuhang ansible_password=xuhang ansible_connection=winrm ansible_winrm_transport=ntlm ansible_port=5985 ansible_winrm_scheme=http</p>
<h2 id="2"><a href="#2" class="headerlink" title="2"></a>2</h2><p><a href="https://www.cnblogs.com/herui1991/p/12304487.html" target="_blank" rel="noopener">https://www.cnblogs.com/herui1991/p/12304487.html</a><br>重点：千万不要yum安装ansible。选择pip3安装，或者二进制包安装。否则，即便安装了pywinrm插件也无法管理Windows主机。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install --user ansible</span><br></pre></td></tr></table></figure></p>
<h2 id="3"><a href="#3" class="headerlink" title="3"></a>3</h2><p>[xuhang@localhost ansible]$ ansible all -m ping<br>[WARNING]: No python interpreters found for host node3 (tried [‘/usr/bin/python’, ‘python3.7’, ‘python3.6’, ‘python3.5’, ‘python2.7’, ‘python2.6’, ‘/usr/libexec/platform-python’, ‘/usr/bin/python3’,<br>‘python’])</p>
<p>这个是因为远程主机是windows，他当成了linux，linux 远程主机需要安装python，至于他为什么当成linux可能是因为这个用的方式不对，不能直接测试ping，应该用下面的例子</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line"># The playbook install 7zip</span><br><span class="line">- hosts: windows</span><br><span class="line">  tasks:</span><br><span class="line">   - name: Ensure 7-Zip is installed via Chocolatey</span><br><span class="line">     win_chocolatey:</span><br><span class="line">       name: 7zip</span><br><span class="line">       state: present</span><br></pre></td></tr></table></figure>
<h2 id="wrm服务"><a href="#wrm服务" class="headerlink" title="wrm服务"></a>wrm服务</h2><p>这个服务在windows server2016是默认打开的，通过命令winrm quickconfig可以打开，提示默认打开，当然这个只是http的方式，https需要证书打开</p>
<h2 id="authentication"><a href="#authentication" class="headerlink" title="authentication"></a>authentication</h2><p><a href="https://docs.ansible.com/ansible/latest/user_guide/windows_winrm.html#basic" target="_blank" rel="noopener">https://docs.ansible.com/ansible/latest/user_guide/windows_winrm.html#basic</a><br>Basic authentication is one of the simplest authentication options to use, but is also the most insecure. This is because the username and password are simply base64 encoded, and if a secure channel is not in use (eg, HTTPS) then it can be decoded by anyone. Basic authentication can only be used for local accounts (not domain accounts).</p>
<p><a href="https://docs.ansible.com/ansible/latest/user_guide/windows_setup.html#winrm-setup" target="_blank" rel="noopener">https://docs.ansible.com/ansible/latest/user_guide/windows_setup.html#winrm-setup</a><br>这一步把basic authentication给打开了，basic需要用户名密码，但是可能需要先执行这个powershell脚本来enable</p>
<h2 id="总结下就是google和百度一起搜找问题的答案"><a href="#总结下就是google和百度一起搜找问题的答案" class="headerlink" title="总结下就是google和百度一起搜找问题的答案"></a>总结下就是google和百度一起搜找问题的答案</h2>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://mengxu2018.github.io/2020/06/04/ansible-windows踩坑/" data-id="ckbxofaif0003couxmq1vnh1w" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/automation/">automation</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-powershell-dsc" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/06/03/powershell-dsc/" class="article-date">
  <time datetime="2020-06-03T12:44:15.000Z" itemprop="datePublished">2020-06-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/06/03/powershell-dsc/">powershell dsc get started</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="guide"><a href="#guide" class="headerlink" title="guide"></a>guide</h2><p><a href="https://docs.microsoft.com/zh-cn/powershell/scripting/dsc/configurations/write-compile-apply-configuration?view=powershell-7" target="_blank" rel="noopener">https://docs.microsoft.com/zh-cn/powershell/scripting/dsc/configurations/write-compile-apply-configuration?view=powershell-7</a></p>
<h2 id="hello-world"><a href="#hello-world" class="headerlink" title="hello world"></a>hello world</h2><p>注意最后一行的HelloWorld一定要加，否则编译不会生成mof文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Configuration HelloWorld &#123;</span><br><span class="line"></span><br><span class="line">    # Import the module that contains the File resource.</span><br><span class="line">    Import-DscResource -ModuleName PsDesiredStateConfiguration</span><br><span class="line"></span><br><span class="line">    # The Node statement specifies which targets to compile MOF files for, when this configuration is executed.</span><br><span class="line">    Node &apos;localhost&apos; &#123;</span><br><span class="line"></span><br><span class="line">        # The File resource can ensure the state of files, or copy them from a source to a destination with persistent updates.</span><br><span class="line">        File HelloWorld &#123;</span><br><span class="line">            DestinationPath = &quot;d:\work\HelloWorld.txt&quot;</span><br><span class="line">            Ensure = &quot;Present&quot;</span><br><span class="line">            Contents   = &quot;Hello World from DSC!&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">HelloWorld</span><br></pre></td></tr></table></figure></p>
<h2 id="编译运行"><a href="#编译运行" class="headerlink" title="编译运行"></a>编译运行</h2><p>. ./HelloWorld.ps1<br>Start-DscConfiguration -Path .\HelloWorld -Verbose -Wait   //会发现d:\work\HelloWorld.txt</p>
<h2 id="troubleshooting"><a href="#troubleshooting" class="headerlink" title="troubleshooting"></a>troubleshooting</h2><p>powershell ise需要admin打开<br>wrm服务要打开</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://mengxu2018.github.io/2020/06/03/powershell-dsc/" data-id="ckbxofaib0001couxrhqmx242" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/powershell/">powershell</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-jwt-first" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/05/05/jwt-first/" class="article-date">
  <time datetime="2020-05-05T14:51:52.000Z" itemprop="datePublished">2020-05-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/05/05/jwt-first/">jwt introduction</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="https://auth0.com/blog/implementing-jwt-authentication-on-spring-boot/" target="_blank" rel="noopener">https://auth0.com/blog/implementing-jwt-authentication-on-spring-boot/</a></p>
<p><a href="https://github.com/mengxu2018/jwt" target="_blank" rel="noopener">https://github.com/mengxu2018/jwt</a></p>
<p>During the authentication process, when a user successfully logs in using their credentials, a JSON Web Token is returned and must be saved locally (typically in local storage). Whenever the user wants to access a protected route or resource (an endpoint), the user agent must send the JWT, usually in the Authorization header using the Bearer schema, along with the request.</p>
<p>JWT is commonly used for authorization，jwt与authentiation没有关系，用户还是得用户名密码或者open connect id来登录，但是后续的访问资源，可以携带之前收到的jwt token来访问，这个token这个时候就起到授权的作用,看下面的文章更详细的解释jwt的workflow</p>
<p><a href="https://jwt.io/introduction/" target="_blank" rel="noopener">https://jwt.io/introduction/</a><br><img src="/images/client-credentials-grant.png" alt="client-credentials-grant.png"></p>
<ol>
<li>The application or client requests authorization to the authorization server. This is performed through one of the different authorization flows. For example, a typical OpenID Connect compliant web application will go through the /oauth/authorize endpoint using the authorization code flow.</li>
<li>When the authorization is granted, the authorization server returns an access token to the application.</li>
<li>The application uses the access token to access a protected resource (like an API).<br>可以看到jwt也是需要一个authorization server生成一个token，只是后续直接用token访问api就好了 </li>
</ol>
<p><a href="https://www.digitalocean.com/community/tutorials/an-introduction-to-oauth-2" target="_blank" rel="noopener">https://www.digitalocean.com/community/tutorials/an-introduction-to-oauth-2</a></p>
<p><a href="https://www.oauth.com/oauth2-servers/the-resource-server/" target="_blank" rel="noopener">https://www.oauth.com/oauth2-servers/the-resource-server/</a></p>
<p>Oauth2 与 JWT 区别？<br>Token功能不一样，JWT的token是包含用户基本信息的，然后通过加密的方式生成的字符串，服务器端拿到这个token之后不需要再去查询用户基本信息，解析完token之后就能拿到。<br>想想在微服务架构下，用户服务是一个单独的服务，但是其他服务大部分情况下也会需要用户信息，难道要每次用到都去取一次吗？ JWT非常适合微服务。</p>
<p>OAuth2用在使用第三方账号登录的情况(比如使用weibo, qq, github登录某个app)<br>JWT是用在前后端分离, 需要简单的对后台API进行保护时使用.(前后端分离无session, 频繁传用户密码不安全)<br>OAuth2是一个相对复杂的协议, 有4种授权模式, 其中的access code模式在实现时可以使用jwt生成code, 也可以不用. 它们之间没有必然的联系.</p>
<p>总结起来就是jwt很轻量级，<a href="https://www.cnblogs.com/grissom007/p/6294746.html，这个文章可以看下" target="_blank" rel="noopener">https://www.cnblogs.com/grissom007/p/6294746.html，这个文章可以看下</a></p>
<p>oauth2的的资源服务器校验token<br><a href="http://springcloud.cn/view/431" target="_blank" rel="noopener">http://springcloud.cn/view/431</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://mengxu2018.github.io/2020/05/05/jwt-first/" data-id="ck6yot4rb0001csuxuub61mmx" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/security/">security</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-ansible-setup" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/03/21/ansible-setup/" class="article-date">
  <time datetime="2020-03-21T12:44:15.000Z" itemprop="datePublished">2020-03-21</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/03/21/ansible-setup/">ansible setup</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="先升级到python3"><a href="#先升级到python3" class="headerlink" title="先升级到python3"></a>先升级到python3</h2><p>参考另外的文章</p>
<h2 id="安装可以下载centos版本的rpm"><a href="#安装可以下载centos版本的rpm" class="headerlink" title="安装可以下载centos版本的rpm"></a>安装可以下载centos版本的rpm</h2><p><a href="https://cbs.centos.org/koji/buildinfo?buildID=27713" target="_blank" rel="noopener">https://cbs.centos.org/koji/buildinfo?buildID=27713</a><br>至于依赖的其他package，可以yum来安装,如果需要管理windows机器就需要使用pip来安装ansible，否则管理windows的python模块不能识别<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install --user ansible</span><br></pre></td></tr></table></figure></p>
<h2 id="ssh免登录"><a href="#ssh免登录" class="headerlink" title="ssh免登录"></a>ssh免登录</h2><p><a href="http://getansible.com/begin/an_zhuang_ansile" target="_blank" rel="noopener">http://getansible.com/begin/an_zhuang_ansile</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 生成ssh key</span><br><span class="line">ssh-keygen</span><br><span class="line"></span><br><span class="line"># 拷贝ssh key到远程主机，ssh的时候就不需要输入密码了</span><br><span class="line">ssh-copy-id remoteuser@remoteserver</span><br><span class="line"></span><br><span class="line"># ssh的时候不会提示是否保存key</span><br><span class="line">$ssh-keyscan remote_servers &gt;&gt; ~/.ssh/known_hosts</span><br></pre></td></tr></table></figure></p>
<p>配置root-&gt;root， ccms-&gt;ccms免登录</p>
<h2 id="ad-hoc-commands"><a href="#ad-hoc-commands" class="headerlink" title="ad-hoc commands"></a>ad-hoc commands</h2><p><a href="https://docs.ansible.com/ansible/latest/user_guide/intro_getting_started.html" target="_blank" rel="noopener">https://docs.ansible.com/ansible/latest/user_guide/intro_getting_started.html</a></p>
<p>下面的命令都可以直接在root执行或者ccms执行<br>ansible all -m copy -a “src=/tmp/xu dest=/tmp/xu2”<br>ansible all -m ping<br>ansible all -a “/sbin/reboot”</p>
<p>如果在root用户下面执行下面的会报错，需要实现root到对方ccms的免登录<br>这个只要执行上面的第二步ssh-copy-id ccms@remoteserver就可以了，因为1，3步在同用户名之间的免登录已经执行过了<br>ansible all -m ping -u ccms</p>
<h2 id="sudo-issue-TODO"><a href="#sudo-issue-TODO" class="headerlink" title="sudo issue (TODO)"></a>sudo issue (TODO)</h2><p>在对方机器执行sudo需要把用户ccms加入到wheel组里面<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">usermod -aG wheel user</span><br></pre></td></tr></table></figure></p>
<p>sudo是ccms的密码，但是需要加入到wheel组里面<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible all -m copy -a &quot;src=/tmp/xu dest=/etc/xu3&quot; -u ccms  --ask-become-pass</span><br></pre></td></tr></table></figure></p>
<p>但是下面的重启会报错<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible all -a &quot;/sbin/reboot&quot; -u ccms --ask-become-pass 会报错</span><br></pre></td></tr></table></figure></p>
<h2 id="playbook"><a href="#playbook" class="headerlink" title="playbook"></a>playbook</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">-</span><br><span class="line">  hosts: all</span><br><span class="line">  name: &quot;install httpd&quot;</span><br><span class="line">  tasks:</span><br><span class="line">    -</span><br><span class="line">      name: &quot;install httpd*&quot;</span><br><span class="line">      yum: &quot;name=httpd state=latest&quot;</span><br></pre></td></tr></table></figure>
<p>上面是一个可以work的例子，安装一个httpd，最顶部的三个dash代表文档的开始，其他的dash可以单独一行也可以不单独一行</p>
<h2 id="ansible-tower"><a href="#ansible-tower" class="headerlink" title="ansible tower"></a>ansible tower</h2><p><a href="https://computingforgeeks.com/install-and-configure-ansible-tower-on-centos-rhel/" target="_blank" rel="noopener">https://computingforgeeks.com/install-and-configure-ansible-tower-on-centos-rhel/</a><br> /bin/ansible-tower-service {start|stop|restart|status}</p>
<h2 id="yaml"><a href="#yaml" class="headerlink" title="yaml"></a>yaml</h2><p>关于yaml中dash的解释，<a href="https://www.reddit.com/r/ansible/comments/5jhff3/when_to_use_dash_in_yaml/" target="_blank" rel="noopener">https://www.reddit.com/r/ansible/comments/5jhff3/when_to_use_dash_in_yaml/</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">tasks:</span><br><span class="line">    - name: date/time stamp</span><br><span class="line">      command: /usr/bin/date</span><br><span class="line">      register: timestamp_start</span><br><span class="line">    - debug: var=timestamp_start</span><br><span class="line">    - name: another task</span><br></pre></td></tr></table></figure></p>
<p>dash表示一个list的开始，如果转换成json你可以看的很清楚有没有dash的差异<br><a href="https://onlineyamltools.com/convert-yaml-to-json" target="_blank" rel="noopener">https://onlineyamltools.com/convert-yaml-to-json</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://mengxu2018.github.io/2020/03/21/ansible-setup/" data-id="ck81l9zif0000mcuxw2s8xdh6" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/automation/">automation</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/11/">11</a><a class="extend next" rel="next" href="/page/3/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/AI/">AI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/IO/">IO</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/OS/">OS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/automation/">automation</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cloud/">cloud</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/database/">database</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/">docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dubbo/">dubbo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/grpc/">grpc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hadoop/">hadoop</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hardware/">hardware</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hbase/">hbase</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/istio/">istio</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/">java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/javascript/">javascript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jvm/">jvm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kafka/">kafka</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kubernetes/">kubernetes</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/maven/">maven</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/microservices/">microservices</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mongodb/">mongodb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mysql/">mysql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nodejs/">nodejs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/powershell/">powershell</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/react/">react</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/redis/">redis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/search/">search</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/security/">security</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spark/">spark</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spring/">spring</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spring-boot/">spring-boot</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tomcat/">tomcat</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/win10/">win10</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/zookeeper/">zookeeper</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/网络/">网络</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/AI/" style="font-size: 10px;">AI</a> <a href="/tags/IO/" style="font-size: 10px;">IO</a> <a href="/tags/OS/" style="font-size: 14.44px;">OS</a> <a href="/tags/automation/" style="font-size: 11.11px;">automation</a> <a href="/tags/cloud/" style="font-size: 10px;">cloud</a> <a href="/tags/database/" style="font-size: 11.11px;">database</a> <a href="/tags/docker/" style="font-size: 11.11px;">docker</a> <a href="/tags/dubbo/" style="font-size: 10px;">dubbo</a> <a href="/tags/git/" style="font-size: 10px;">git</a> <a href="/tags/grpc/" style="font-size: 10px;">grpc</a> <a href="/tags/hadoop/" style="font-size: 10px;">hadoop</a> <a href="/tags/hardware/" style="font-size: 11.11px;">hardware</a> <a href="/tags/hbase/" style="font-size: 10px;">hbase</a> <a href="/tags/istio/" style="font-size: 10px;">istio</a> <a href="/tags/java/" style="font-size: 17.78px;">java</a> <a href="/tags/javascript/" style="font-size: 11.11px;">javascript</a> <a href="/tags/jvm/" style="font-size: 11.11px;">jvm</a> <a href="/tags/kafka/" style="font-size: 20px;">kafka</a> <a href="/tags/kubernetes/" style="font-size: 16.67px;">kubernetes</a> <a href="/tags/linux/" style="font-size: 15.56px;">linux</a> <a href="/tags/maven/" style="font-size: 12.22px;">maven</a> <a href="/tags/microservices/" style="font-size: 10px;">microservices</a> <a href="/tags/mongodb/" style="font-size: 10px;">mongodb</a> <a href="/tags/mysql/" style="font-size: 10px;">mysql</a> <a href="/tags/nodejs/" style="font-size: 10px;">nodejs</a> <a href="/tags/powershell/" style="font-size: 14.44px;">powershell</a> <a href="/tags/python/" style="font-size: 11.11px;">python</a> <a href="/tags/react/" style="font-size: 10px;">react</a> <a href="/tags/redis/" style="font-size: 10px;">redis</a> <a href="/tags/search/" style="font-size: 12.22px;">search</a> <a href="/tags/security/" style="font-size: 13.33px;">security</a> <a href="/tags/spark/" style="font-size: 18.89px;">spark</a> <a href="/tags/spring/" style="font-size: 12.22px;">spring</a> <a href="/tags/spring-boot/" style="font-size: 10px;">spring-boot</a> <a href="/tags/tomcat/" style="font-size: 10px;">tomcat</a> <a href="/tags/win10/" style="font-size: 10px;">win10</a> <a href="/tags/zookeeper/" style="font-size: 10px;">zookeeper</a> <a href="/tags/网络/" style="font-size: 10px;">网络</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">November 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">June 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">March 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">June 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">May 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/11/25/microservice-basic/">microservice basics</a>
          </li>
        
          <li>
            <a href="/2021/11/25/maven-parent-bom/">BOM dependency vs Parent Dependancy in Maven</a>
          </li>
        
          <li>
            <a href="/2021/11/06/machine-learning-basics/">machine learning basic</a>
          </li>
        
          <li>
            <a href="/2021/07/09/k8s-pv/">k8s pv</a>
          </li>
        
          <li>
            <a href="/2021/07/05/kafka-leader选举/">kafka leader选举</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 xu, hang<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>